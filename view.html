<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <style>
    img { align: middle; display: block; min-height: 50px; }
    nav {
      position: fixed;
      left: 5px;
      top: 5px;
      bottom: 5px;
    }
    nav > div {
      overflow-y: scroll;
      overflow-x: auto;
      max-height: 95%;
      display: none;
    }
    nav:focus-within > div {
      display: block;
    }
    </style>
    <script type="module">
    const images = await fetch("/data").then(r => r.json())

    const main = document.getElementsByTagName("center")[0]
    const nav = document.getElementsByTagName("nav")[0].lastElementChild

    let count = 0
    for (let section in images) {
      const link = document.createElement("a")
      link.setAttribute("href", "#"+section)
      link.innerText = section
      const div = document.createElement("div")
      div.appendChild(link)
      nav.appendChild(div)
      const anchor = document.createElement("div")
      anchor.id = section
      main.appendChild(anchor)
      images[section].forEach(file => {
	const img = document.createElement("img")
	img.setAttribute("src", file)
	if (count > 5) {
	  img.setAttribute("loading", "lazy")
	}
	count++
	main.appendChild(img)
      })
    }
    </script>
    <title>Read manga</title>
  </head>
  <body>
    <noscript>You need javascript to view this page.</noscript>
    <nav>
      <button tabindex="0">Menu</button>
      <div></div>
    </nav>
    <center></center>
  </body>
</html>
